<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Daily Briefing</title>
  <style>
    :root { --bg:#0f172a; --card:#111827; --text:#e5e7eb; --muted:#94a3b8; --accent:#38bdf8; }
    body { margin:0; font-family:system-ui,sans-serif; background:var(--bg); color:var(--text);}
    header { padding:16px; border-bottom:1px solid #1f2937; background:#111827; position:sticky; top:0;}
    h1 { margin:0; font-size:22px; }
    .wrap { max-width:1100px; margin:0 auto; padding:20px; display:grid; gap:20px; }
    .card { background:var(--card); border:1px solid #1f2937; border-radius:16px; padding:16px;}
    .card h2 { margin:0 0 10px; font-size:18px;}
    .list { list-style:none; padding:0; margin:0;}
    .list li { padding:6px 0; border-bottom:1px dashed #334155;}
    .muted { color:var(--muted); font-size:13px;}
  </style>
</head>
<body>
<header>
  <h1>ì˜¤ëŠ˜ì˜ ë¸Œë¦¬í•‘</h1>
  <div id="todayStr" class="muted"></div>
</header>

<div class="wrap">
  <!-- ë‚ ì”¨ -->
  <section class="card">
    <h2>â˜€ï¸ ì˜¤ëŠ˜ ë‚ ì”¨ & 7ì¼ ì˜ˆë³´</h2>
    <input id="city" value="Seoul"/><button id="btnWeather">ì—…ë°ì´íŠ¸</button>
    <div id="weatherNow"></div>
    <ul id="weather7" class="list"></ul>
  </section>

  <!-- ìš´ì„¸ -->
  <section class="card">
    <h2>ğŸ”® ì˜¤ëŠ˜ì˜ ìš´ì„¸ (1985-04-18)</h2>
    <div id="fortune"></div>
  </section>

  <!-- ì¢…ê°€ -->
  <section class="card">
    <h2>ğŸ“Š ì „ì¼ ì¢…ê°€</h2>
    <div id="close"></div>
  </section>

  <!-- ë‰´ìŠ¤ -->
  <section class="card">
    <h2>ğŸ›ï¸ ì •ì¹˜</h2><ul id="politics" class="list"></ul>
  </section>
  <section class="card">
    <h2>ğŸ’µ ê²½ì œ</h2><ul id="economy" class="list"></ul>
  </section>
  <section class="card">
    <h2>ğŸ‘¥ ì‚¬íšŒ</h2><ul id="society" class="list"></ul>
  </section>
  <section class="card">
    <h2>ğŸŒ êµ­ì œ</h2><ul id="world" class="list"></ul>
  </section>

  <section class="card">
    <h2>ğŸ“ ì¢…í•© ìš”ì•½</h2>
    <div id="wrapSummary"></div>
    <h3>ğŸ“ˆ íˆ¬ì ì‹œì‚¬ì </h3>
    <div id="investSummary"></div>
  </section>
</div>

<script>
// ê³µí†µ
const $=q=>document.querySelector(q);
$('#todayStr').textContent=new Date().toLocaleString('ko-KR');

// ìš´ì„¸
$('#fortune').textContent="ì˜¤ëŠ˜ì€ ê¸°íšŒê°€ ì°¾ì•„ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìƒˆë¡œìš´ ë„ì „ì„ ë‘ë ¤ì›Œí•˜ì§€ ë§ˆì„¸ìš”.";

// ì¢…ê°€
async function loadClose(){
  try{
    const j=await fetch('data/close.json').then(r=>r.json());
    $('#close').textContent=`S&P500 ${j.values.SPX}, NASDAQ ${j.values.IXIC}, Dow ${j.values.DJI}, KOSPI ${j.values.KOSPI} (ê¸°ì¤€ì¼: ${j.date})`;
  }catch(e){$('#close').textContent='ë°ì´í„° ì—†ìŒ';}
}
loadClose();

// ë‚ ì”¨
const weatherMap={0:"ë§‘ìŒ",1:"ëŒ€ì²´ë¡œ ë§‘ìŒ",2:"ë¶€ë¶„ì ìœ¼ë¡œ íë¦¼",3:"íë¦¼",45:"ì•ˆê°œ",48:"ìƒì¸µì•ˆê°œ",
51:"ì´ìŠ¬ë¹„ ì•½í•¨",53:"ì´ìŠ¬ë¹„ ë³´í†µ",55:"ì´ìŠ¬ë¹„ ê°•í•¨",61:"ë¹„ ì•½í•¨",63:"ë¹„ ë³´í†µ",65:"ë¹„ ê°•í•¨",
71:"ëˆˆ ì•½í•¨",73:"ëˆˆ ë³´í†µ",75:"ëˆˆ ê°•í•¨",80:"ì†Œë‚˜ê¸° ì•½í•¨",81:"ì†Œë‚˜ê¸° ë³´í†µ",82:"ì†Œë‚˜ê¸° ê°•í•¨"};
async function loadWeather(city){
  try{
    const g=await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${city}&count=1&language=ko&format=json`).then(r=>r.json());
    const {latitude,longitude}=g.results[0];
    const url=`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current=temperature_2m,weather_code&daily=temperature_2m_max,temperature_2m_min,weather_code&timezone=Asia%2FSeoul`;
    const j=await fetch(url).then(r=>r.json());
    $('#weatherNow').textContent=`í˜„ì¬ ${j.current.temperature_2m}Â°C Â· ${weatherMap[j.current.weather_code]||''}`;
    $('#weather7').innerHTML=j.daily.time.map((t,i)=>
      `<li>${t}: ${j.daily.temperature_2m_max[i]}Â°/${j.daily.temperature_2m_min[i]}Â° Â· ${weatherMap[j.daily.weather_code[i]]||''}</li>`
    ).join('');
  }catch(e){$('#weatherNow').textContent='ë‚ ì”¨ ë¡œë”© ì‹¤íŒ¨';}
}
$('#btnWeather').onclick=()=>loadWeather($('#city').value);
loadWeather('Seoul');

// ë‰´ìŠ¤
async function loadNews(){
  try{
    const j=await fetch('data/news.json').then(r=>r.json());
    const render=(id,arr)=>$(id).innerHTML=arr.map(a=>`<li><a href="${a.url}" target="_blank">${a.title}</a><div class="muted">${a.summary}</div></li>`).join('');
    render('#politics',j.sections.politics);
    render('#economy',j.sections.economy);
    render('#society',j.sections.society);
    render('#world',j.sections.world);
    $('#wrapSummary').textContent=j.wrap_summary;
    $('#investSummary').textContent=j.invest_summary;
  }catch(e){$('#wrapSummary').textContent='ë‰´ìŠ¤ ë°ì´í„° ì—†ìŒ';}
}
loadNews();
</script>
</body>
</html>
