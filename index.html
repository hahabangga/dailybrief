<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Daily Briefing</title>
  <style>
    :root { --bg:#0f172a; --card:#111827; --text:#e5e7eb; --muted:#94a3b8; --accent:#38bdf8; }
    * { box-sizing:border-box }
    body { margin:0; font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", Helvetica, Arial, "Apple SD Gothic Neo", "Malgun Gothic", sans-serif; background:var(--bg); color:var(--text); }
    header { padding:16px 20px; border-bottom:1px solid #1f2937; position:sticky; top:0; background:linear-gradient(180deg, rgba(15,23,42,.98), rgba(15,23,42,.92)); backdrop-filter: blur(6px); z-index:10; }
    .nav { display:flex; gap:12px; align-items:center; flex-wrap:wrap }
    .nav a { color:var(--accent); text-decoration:none; font-size:14px }
    h1 { margin:0; font-size:22px; letter-spacing:.3px; }
    .sub { color:var(--muted); font-size:13px; margin-top:4px }
    .wrap { max-width:1100px; margin:0 auto; padding:22px; display:grid; grid-template-columns: 1fr; gap:18px }
    @media (min-width: 980px) { .wrap { grid-template-columns: 1.1fr 1fr; } }
    .card { background:var(--card); border:1px solid #1f2937; border-radius:16px; padding:16px; box-shadow: 0 10px 24px rgba(0,0,0,.25); }
    .card h2 { margin:0 0 10px; font-size:18px; }
    .row { display:flex; gap:10px; flex-wrap:wrap }
    .muted { color:var(--muted); font-size:13px }
    .kpi { display:grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap:10px }
    .kpi .tile { background:#0b1220; border:1px solid #1f2937; padding:10px 12px; border-radius:12px; }
    .tile .label { color:#9CA3AF; font-size:12px }
    .tile .value { font-size:16px; margin-top:4px }
    .list { list-style:none; padding:0; margin:0 }
    .list li { padding:8px 0; border-top:1px dashed #223046; }
    .list li:first-child { border-top:none }
    a { color: var(--accent); text-decoration:none }
    .pill { display:inline-block; padding:2px 8px; border:1px solid #334155; border-radius:999px; font-size:12px; color:#a5b4fc; }
    .tvwrap { border-radius:12px; overflow:hidden; border:1px solid #223046; }
    .eng { margin-top:10px; padding:10px; background:#0b1220; border-radius:10px }
    .eng .sentence { font-size:16px; margin-bottom:6px; }
    .eng .trans { color:#a5f3fc; font-size:14px; margin-bottom:6px; }
    .eng .grammar, .eng .vocab { color:#cbd5e1; font-size:13px; margin-bottom:4px; }
    footer { text-align:center; padding:16px; }
  </style>
</head>
<body>
<header>
  <div class="nav">
    <h1>ì˜¤ëŠ˜ì˜ ë¸Œë¦¬í•‘</h1>
    <span style="flex:1"></span>
    <a href="listening.html">ì˜ì–´ ë¦¬ìŠ¤ë‹</a>
  </div>
  <div class="sub" id="todayStr">ë¡œë”© ì¤‘â€¦</div>
</header>

<div class="wrap">
  <!-- â˜€ï¸ ë‚ ì”¨ -->
  <section class="card">
    <h2>â˜€ï¸ ì˜¤ëŠ˜ ë‚ ì”¨ & 7ì¼ ì˜ˆë³´</h2>
    <input id="city" placeholder="ë„ì‹œ" value="Seoul" />
    <button id="btnWeather">ì—…ë°ì´íŠ¸</button>
    <div id="weatherNow"></div>
    <ul id="weather7" class="list"></ul>
  </section>

  <!-- ğŸ”® ìš´ì„¸ -->
  <section class="card">
    <h2>ğŸ”® ì˜¤ëŠ˜ì˜ ìš´ì„¸ (1985-04-18)</h2>
    <div id="fortune"></div>
    <div id="zodiacLabel" class="muted"></div>
  </section>

  <!-- ğŸ“Š ì „ì¼ ì¢…ê°€ -->
  <section class="card" style="grid-column:1/-1">
    <h2>ğŸ“Š ì „ì¼ ì¢…ê°€</h2>
    <div class="kpi">
      <div class="tile"><div class="label">S&P 500</div><div class="value" id="spxClose">-</div></div>
      <div class="tile"><div class="label">NASDAQ</div><div class="value" id="ixicClose">-</div></div>
      <div class="tile"><div class="label">Dow Jones</div><div class="value" id="djiClose">-</div></div>
      <div class="tile"><div class="label">KOSPI</div><div class="value" id="kospiClose">-</div></div>
    </div>
    <div class="muted" id="closeDate"></div>
  </section>

  <!-- ğŸ“ˆ ì°¨íŠ¸ -->
  <section class="card" style="grid-column:1/-1">
    <h2>ğŸ“ˆ ì§€ìˆ˜ ì°¨íŠ¸</h2>
    <div class="tvwrap">
      <div class="tradingview-widget-container" style="height:400px">
        <div class="tradingview-widget-container__widget"></div>
        <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-market-overview.js" async>
        {
          "colorTheme": "dark",
          "dateRange": "1D",
          "showChart": true,
          "locale": "ko",
          "width": "100%",
          "height": "400",
          "isTransparent": false,
          "showSymbolLogo": true,
          "tabs": [
            { "title": "ë¯¸êµ­", "symbols": [
              {"s":"FOREXCOM:SPXUSD","d":"S&P 500"},
              {"s":"NASDAQ:IXIC","d":"NASDAQ"},
              {"s":"DJ:DJI","d":"Dow Jones"} ] },
            { "title": "í•œêµ­", "symbols": [
              {"s":"KRX:KOSPI","d":"KOSPI"},
              {"s":"KRX:KOSDAQ","d":"KOSDAQ"} ] }
          ]
        }
        </script>
      </div>
    </div>
  </section>

  <!-- ğŸ‡ºğŸ‡¸/ğŸŒ ë‰´ìŠ¤ -->
  <section class="card"><h2>ğŸ‡ºğŸ‡¸ ë¯¸êµ­ ì¦ì‹œ</h2><ul id="usStockNews" class="list"></ul></section>
  <section class="card"><h2>ğŸ’µ ë¯¸êµ­ ê²½ì œ</h2><ul id="usEconNews" class="list"></ul></section>
  <section class="card"><h2>ğŸ›ï¸ ë¯¸êµ­ ì •ì¹˜</h2><ul id="usPolNews" class="list"></ul></section>
  <section class="card" style="grid-column:1/-1"><h2>ğŸŒ ì„¸ê³„ ì´ìŠˆ</h2><ul id="worldNews" class="list"></ul></section>

  <!-- ğŸ—£ ì˜ì–´ í•œë§ˆë”” -->
  <section class="card" style="grid-column:1/-1">
    <h2>ğŸ—£ ì˜ì–´ í•œë§ˆë””</h2>
    <div class="eng">
      <div class="sentence" id="engSentence"></div>
      <div class="trans" id="engTrans"></div>
      <div class="grammar" id="engGrammar"></div>
      <div class="vocab" id="engVocab"></div>
    </div>
  </section>
</div>

<footer class="sub">Â© <span id="year"></span> Daily Briefing</footer>

<script>
const CONFIG = { ALPHA_KEY:'', birthday:'1985-04-18' };
$('#todayStr').textContent = new Date().toLocaleString('ko-KR');
$('#year').textContent = new Date().getFullYear();
function $(q){return document.querySelector(q)}

// === ë‰´ìŠ¤ ìš”ì•½: data/news.json ìš°ì„  ===
async function loadNews(){
  try{
    const r=await fetch('data/news.json?ts='+Date.now());
    if(r.ok){
      const j=await r.json(); const S=j.sections||{};
      const render=(id,arr)=>{ if(!arr) return;
        $(id).innerHTML=arr.map(a=>`<li><a href="${a.url}" target="_blank">${a.title}</a><div class="muted">${a.summary||''}</div></li>`).join('');
      };
      render('#usStockNews',S.us_stock);
      render('#usEconNews',S.us_econ);
      render('#usPolNews',S.us_politics);
      render('#worldNews',S.world);
      return;
    }
  }catch(e){}
  // í´ë°±: êµ¬ê¸€ë‰´ìŠ¤ ë§í¬
  $('#usStockNews').innerHTML='<li><a href="https://news.google.com/search?q=US%20stock%20market">ë¯¸êµ­ ì¦ì‹œ ë‰´ìŠ¤</a></li>';
  $('#usEconNews').innerHTML='<li><a href="https://news.google.com/search?q=US%20economy">ë¯¸êµ­ ê²½ì œ ë‰´ìŠ¤</a></li>';
  $('#usPolNews').innerHTML='<li><a href="https://news.google.com/search?q=US%20politics">ë¯¸êµ­ ì •ì¹˜ ë‰´ìŠ¤</a></li>';
  $('#worldNews').innerHTML='<li><a href="https://news.google.com/topics/CAAqJggKIiBDQkFTRWdvSUwyMHZNRFZxYUdjU0FtVnVLQUFQAQ">ì„¸ê³„ ë‰´ìŠ¤</a></li>';
}
loadNews();

// === ìš´ì„¸
function zodiac(m,d){ if((m==4&&d<=19)||(m==3&&d>=21)) return 'ì–‘ìë¦¬'; return 'ê¸°íƒ€ìë¦¬'; }
$('#fortune').textContent='ì˜¤ëŠ˜ì€ ì¢‹ì€ ê¸°íšŒê°€ ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
$('#zodiacLabel').textContent=zodiac(4,18);

// === ì˜ì–´ í•œë§ˆë””
const PHRASES=[{en:'Keep your focus, and the rest will follow.',ko:'ì§‘ì¤‘í•˜ë©´ ë‚˜ë¨¸ì§€ëŠ” ë”°ë¼ì˜¨ë‹¤.',grammar:'ëª…ë ¹ë¬¸+ë“±ìœ„ì ‘ì†ì‚¬',vocab:[['focus','ì§‘ì¤‘'],['follow','ë”°ë¼ì˜¤ë‹¤']]}];
const pick=PHRASES[0];
$('#engSentence').textContent=pick.en;
$('#engTrans').textContent=pick.ko;
$('#engGrammar').textContent='ë¬¸ë²•: '+pick.grammar;
$('#engVocab').textContent='ë‹¨ì–´: '+pick.vocab.map(([w,m])=>`${w}(${m})`).join(', ');

// === ì „ì¼ ì¢…ê°€ (JSONâ†’Alpha)
async function loadClose(){
  try{
    const r=await fetch('data/close.json?ts='+Date.now());
    if(r.ok){const j=await r.json();
      $('#spxClose').textContent=j.values.SPX;
      $('#ixicClose').textContent=j.values.IXIC;
      $('#djiClose').textContent=j.values.DJI;
      $('#kospiClose').textContent=j.values.KOSPI;
      $('#closeDate').textContent='ê¸°ì¤€ì¼: '+j.date;
      return;
    }
  }catch(e){}
  $('#closeDate').textContent='ë°ì´í„° ì—†ìŒ';
}
loadClose();

// === ë‚ ì”¨
async function loadWeather(city){
  try{
    const g=await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${city}&count=1&language=ko&format=json`).then(r=>r.json());
    const {latitude,longitude}=g.results[0];
    const url=`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current=temperature_2m,weather_code&daily=temperature_2m_max,temperature_2m_min,weather_code&timezone=Asia%2FSeoul`;
    const j=await fetch(url).then(r=>r.json());
    $('#weatherNow').textContent=`í˜„ì¬ê¸°ì˜¨ ${j.current.temperature_2m}Â°C`;
    $('#weather7').innerHTML=j.daily.time.map((t,i)=>`<li>${t}: ${j.daily.temperature_2m_max[i]}Â° / ${j.daily.temperature_2m_min[i]}Â°</li>`).join('');
  }catch(e){$('#weatherNow').textContent='ë‚ ì”¨ ë¡œë”© ì‹¤íŒ¨';}
}
$('#btnWeather').onclick=()=>loadWeather($('#city').value);
loadWeather('Seoul');
</script>
</body>
</html>
